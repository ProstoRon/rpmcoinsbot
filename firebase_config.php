<?php
require 'vendor/autoload.php'; // Подключение автозагрузчика Composer

use Kreait\Firebase\Factory;
use Kreait\Firebase\ServiceAccount;


$encodedKey = 'LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tXG5NSUlFdlFJQkFEQU5CZ2txaGtpRzl3MEJBUUVGQUFTQ0JLY3dnZ1NqQWdFQUFvSUJBUUNZTWVmMHJicmpqOVJ5XG42ZFREUk5sK2FCcTRKSGwyaGxXVzJmSldvOExiZnRGNWVhOEUweWFqWDVUWGxHakVWZWpLS0xQS25BUmtwT3BhXG41YXdCanAxWk5hVE1DNndrZHo5SWRCa3BlOW9DNWpOazRFcWpEQ3NmZnFUd3BCYXFBcElGc1plWTh3U1E2dnhOXG5HL3RtZERYZWw3aEpBRGNZS3R2dEhLcFdvVG02NmpRTkZSZFgzVXJweitHQ1EyRWJBZjFoVnVUM1FtY0xBdFAxXG5qQ0l3UjNUcjZoTjdiWHhBbGw4N3dCZVBsNy9lOVR6KzExbUdFOEVkbmpocldoMy9lTXVXSXhjbmxObCtQRU4yXG5pa2YvWndsWWxnVFJoNlJieWtRV0dHNzVpSWxLQi9YdmdGcXBqazN5U0cwNFl2ZDA1V0ZxZEFBNW9xalFiN2J6XG5STlllelMwbkFnTUJBQUVDZ2dFQUNjM2o0K3E4ZmRsYVN4Yk9KU1Y1SDFWWjEwcWVPbjVDalpKaVhxWWVXNHZLXG50eGtaZkdXVkk4bDRxZjgrVlREZ1FLNytPZ3RINnlzeE5RUW85YWE0SGQyVitBRU9mZ0Rpa09wNFk5TG9nMFJNXG53NW1yK29ucytKS1hmSVc0TjJFdFYvUTRwYS9qWWo4enNVeWdBQzhmVGU5c2ZlTm5mb1U2OVZ1TWk1ZkhtTWRSXG5LUTI1ZXBVWXAvanhQT2FaaVJMSjU0NE9qU0tXSUxlajA2V2tCMTEwSlVhK2dvMFhVRWJyeG94ZEg3UXhpdU1QXG5mS2xIOUQ2Ymk2OFZ5N3lLdGRmUjM2d1lrby9MeHhqRW9ocnRnSGl1YUVTMndpa2dNZXp2b1gwRHdQLzdxOHNPXG5VNzhwQnJhU0kzb0VoUlR0RG1OOWtxTUJzZzJMNWhJZjZzZ0Z1S29obFFLQmdRRElDYWVjamV3UjlaTHJUVlJRXG5WcVdJRURpWVZWb0xQR3ZoUGVCbFhRSW44S1dDUTJ1c2Mrbk9KV1pJbUh2Rm9rSjRDREYyMldLUXhHUTZOeUF2XG5TZWVXK2Q4V1NGSVRWMkpCbTUyZGFhT0hoWW9EMFhxcE45S1NLSnd5MWUrOStzeHI2dm1zWlpOR01lNi9CNmluXG4rVkdVS2hHS1lEWmxNdDl3OS9XR1NoUG5KUUtCZ1FEQ3hkWmVyMk9FNkhWY25MdjdpSlZsM1NieG5WSTVxNGtFXG41Q1p5U3EvQ09zL3FFSXZlMndwOWt2alJxTlo0N0dpUk4yYi9ha0FTcGlNSWJxUE1UZnlyOXcwcGx5dlZKVkFMXG5NM04zWktXSGh3QWpPalZ4NHBwVW9jTElHK1JFV0VEMWQvVzJCbEVhaHBxcDJVZzd4dHNGdjEwM0hkWlhkNUFYXG5tWllxakVnSFd3S0JnUUN4ZS85L1pGemt3bU1NNjV1M2ZHbDZoQW55L3lmWmVFNnZsdHNXbEtOcEZKZUZNSlRFXG5la1FrYUFLTXZ0NXl5RGo1anl0MExBVE1OYlJJQXNsSHErY1RpYmhxYU5pSjJLcVJVNlZSR1gzQ3JMVjhGYzBqXG5meWdTRG40b2pMRWVldndOZEhyNmYxVmduc1VhTVkxdkhFTkpsdG5oVU9SeWZlVEtzdmJobzdCdEVRS0JnQ3gzXG5Zak9Ic3g2NnUyQ0RYOTlURlZpR0hzZjJkTGs1MGpSTnFnRlp6N3AyRnRXSEpZZWhWa25JN2dsZmxHZFRBYVIxXG5rNHdvUTZ4K1JXMDlaU1BWZ2lQNGFRYmZ2bUFRL3E4djllS0NGZEJWSDlEckR4eUs4VlQxQVRVU09SRHBYUnN0XG5ZZWxHayttTVpXNzFiaXBIZ2VWVUJRSDZTOTc0S3V0WVl4SWZxS29WQW9HQWFIdTBqUkVUeDhQNU92TzgvTC9zXG5wZWxHaUt2NlZmSzVSWjhwZXNkbCtRdktXVEVKcjdvNW9jUVhuWDN6dkloWHR6ZWRkTWdKZGhBRFNDcXNpdlFBXG5HakVYUm5ZYkt4MjZBS3Brb0szem9BNGRHbEJJV1JUKzZ1RlRtS0tzZmZCNHE3dUh5a1hPNXZ6VmNIVmFPTXcxXG5hbzVsVDAxeHFzblF4NjRXY2o1MTM2UT1cbi0tLS0tRU5EIFBSSVZBVEUgS0VZLS0tLS1cbg==';

$privateKey = base64_decode($encodedKey);


$keyFilePath = '/tmp/keys.json';
file_put_contents($keyFilePath, json_encode([
    "type" => "service_account",
    "project_id" => "rpmcoins-48e4f",
    "private_key_id" => "cc50a0bd4301b12821b61fc64ca010545ee4922b",
    "private_key" => $privateKey,
    "client_email" => "firebase-adminsdk-8rmo2@rpmcoins-48e4f.iam.gserviceaccount.com",
    "client_id" => "114278276030303711399",
    "auth_uri" => "https://accounts.google.com/o/oauth2/auth",
    "token_uri" => "https://oauth2.googleapis.com/token",
    "auth_provider_x509_cert_url" => "https://www.googleapis.com/oauth2/v1/certs",
    "client_x509_cert_url" => "https://www.googleapis.com/robot/v1/metadata/x509/firebase-adminsdk-8rmo2%40rpmcoins-48e4f.iam.gserviceaccount.com",
    "universe_domain" => "googleapis.com"
]));

$serviceAccount = ServiceAccount::fromJsonFile($keyFilePath);

$firebase = (new Factory)
    ->withServiceAccount($serviceAccount)
    ->withDatabaseUri('https://rpmcoins-48e4f-default-rtdb.firebaseio.com')
    ->create();

$database = $firebase->getDatabase();

// Очистка временного файла
unlink($keyFilePath);
?>
